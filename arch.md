# Yccol 代理池系统架构文档

## 1. 项目概述

Yccol 是一个基于 FOFA 搜索引擎抓取的代理池工具，提供多种版本以满足不同用户需求。该系统能够自动获取、验证和管理代理 IP，支持 HTTP、HTTPS 和 SOCKS5 等多种代理协议，并提供 API 接口、命令行工具和图形界面等多种使用方式。

### 1.1 核心功能

- 基于 FOFA 搜索引擎抓取代理 IP
- 多线程验证代理可用性
- 支持 HTTP、HTTPS 和 SOCKS5 代理
- 提供 API 接口供第三方调用
- 支持代理 IP 自动切换
- 支持按地区筛选代理 IP
- 提供命令行和图形界面操作

### 1.2 版本划分

- **API 版本**：提供 RESTful API 接口，支持远程调用
- **Pro 版本**：高级命令行工具，提供完整功能
- **GUI 版本**：图形用户界面，易于操作
- **基础版本**：简化版命令行工具，提供核心功能

## 2. 系统架构

### 2.1 总体架构

Yccol 代理池系统采用模块化设计，主要分为以下几个核心模块：

1. **数据获取模块**：负责从 FOFA 搜索引擎获取代理 IP
2. **数据处理模块**：负责处理和格式化获取的代理 IP 数据
3. **代理验证模块**：负责验证代理 IP 的可用性
4. **代理管理模块**：负责管理和切换代理 IP
5. **用户接口模块**：提供 API、命令行和图形界面等多种交互方式

### 2.2 模块关系图

```
+------------------+     +------------------+     +------------------+
|                  |     |                  |     |                  |
|   数据获取模块    +---->+   数据处理模块    +---->+   代理验证模块    |
|                  |     |                  |     |                  |
+------------------+     +------------------+     +--------+---------+
                                                          |
                                                          v
+------------------+     +------------------+     +------------------+
|                  |     |                  |     |                  |
|   用户接口模块    +<----+   配置管理模块    |<----+   代理管理模块    |
|                  |     |                  |     |                  |
+------------------+     +------------------+     +------------------+
```

## 3. 核心模块详解

### 3.1 API 版本 (API/)

API 版本提供 RESTful 接口，允许用户通过 HTTP 请求获取和管理代理 IP。

#### 3.1.1 主要组件

- **app.py**：Flask 应用主入口，提供 API 路由和请求处理
- **IP_address.py**：IP 地址处理工具
- **cn_yanzheng.py/fcn_yanzheng.py**：中国/国外代理验证模块

#### 3.1.2 目录结构

- **config/**：配置文件和配置管理模块
- **data_process/**：数据处理模块，包含代理验证逻辑
- **output/**：输出目录，存储处理后的代理列表
- **request_abt/**：请求抽象模块，处理 HTTP 请求

#### 3.1.3 API 接口

API 版本提供以下主要接口：

- `/api/users`：获取用户信息和验证密钥
- 支持参数：
  - `key`：API 密钥
  - `proxy`：代理类型（http、https、socks5）
  - `area`：地区筛选（all、cn、fcn）
  - `accuracy`：验证次数（1-3）
  - `quantity`：获取数量

### 3.2 Pro 版本 (Pro/)

Pro 版本是一个功能完整的命令行工具，提供更多高级功能和选项。

#### 3.2.1 主要组件

- **Yccol-Pro.py**：主程序入口，提供命令行参数解析和功能调用

#### 3.2.2 目录结构

- **config/**：配置文件和配置管理模块
- **data_process/**：数据处理模块
- **output/**：输出目录
- **request_abt/**：请求处理模块
- **tools/**：工具集合

#### 3.2.3 命令行参数

Pro 版本支持多种命令行参数，包括：

- `-f/--fofa_get_ip`：通过 FOFA 获取 IP
- `-vo/--Ver_out_ip`：验证 IP
- `-s/--switch_ip`：开启切换 IP 功能
- `-a/--Automatic_ip`：自动运行整套程序
- `-fs/--get_socks5`：获取 SOCKS5 代理池
- `-sy/--yanzheng_socks5`：验证 SOCKS5 代理池
- `-sq/--socks5_switch`：切换 SOCKS5 代理池
- `-v/--version`：获取当前版本
- `-R/--re_time`：设置 IP 切换速率
- `-P/--re_prot`：设置端口号
- 等其他参数

### 3.3 GUI 版本 (GUI/)

GUI 版本提供图形用户界面，方便非技术用户使用。

#### 3.3.1 主要组件

- **Yccol - GUI.py**：GUI 主程序，基于 PyQt5 实现
- **icon.ico**：应用图标

#### 3.3.2 目录结构

- **config/**：配置文件
- **dist/**：打包发布目录
- **get_response/**：响应处理模块
- **GUi/**：GUI 组件模块

#### 3.3.3 界面功能

GUI 版本提供友好的用户界面，包括：

- 密钥验证界面
- 代理获取和管理界面
- 设置界面
- 状态显示

### 3.4 基础版本 (fifa0/)

基础版本是一个简化的命令行工具，提供核心功能。

#### 3.4.1 主要组件

- **fifa0.py**：主程序入口
- **proxy_qh.py**：代理切换模块

#### 3.4.2 目录结构

- **config/**：配置文件
- **data_process/**：数据处理模块
- **dist/**：打包发布目录
- **output/**：输出目录
- **request_abt/**：请求处理模块

## 4. 数据流程

### 4.1 代理获取流程

1. 用户通过接口/命令行/GUI 发起请求
2. 系统验证用户身份和权限
3. 系统构造 FOFA 查询语句并发送请求
4. 接收 FOFA 返回的代理 IP 数据
5. 处理和格式化代理 IP 数据
6. 将代理 IP 数据保存到文件或数据库

### 4.2 代理验证流程

1. 从文件或数据库读取代理 IP 列表
2. 创建多线程验证任务
3. 对每个代理 IP 发送测试请求
4. 根据响应结果判断代理可用性
5. 将可用代理保存到文件或数据库

### 4.3 代理切换流程

1. 从文件或数据库读取可用代理列表
2. 根据配置的切换速率定时切换代理
3. 设置系统代理或应用代理
4. 监控代理可用性，必要时重新选择代理

## 5. 技术栈

### 5.1 编程语言

- Python 3.x

### 5.2 主要依赖库

- **Flask**：Web 框架，用于 API 实现
- **Requests**：HTTP 客户端库，用于发送请求
- **PyQt5**：GUI 框架，用于图形界面实现
- **MySQL Connector**：MySQL 数据库连接器
- **Threading**：多线程库，用于并发处理
- **UUID**：生成唯一标识符

### 5.3 外部依赖

- **FOFA 搜索引擎**：用于获取代理 IP 数据
- **MySQL 数据库**：用于存储用户信息和代理数据（API 版本）

## 6. 安全机制

### 6.1 用户认证

- 基于密钥的 API 认证
- 密钥有效期管理
- MAC 地址绑定（部分版本）

### 6.2 数据安全

- 敏感配置信息加密存储
- 代理 IP 数据定期更新
- 验证失败的代理自动剔除

## 7. 扩展性设计

### 7.1 模块化架构

系统采用模块化设计，各功能模块相对独立，便于扩展和维护。

### 7.2 可配置项

- 代理获取参数可配置
- 验证规则可配置
- 切换策略可配置

### 7.3 扩展点

- 支持添加新的代理来源
- 支持添加新的验证方法
- 支持添加新的代理协议

## 8. 部署要求

### 8.1 环境要求

- Python 3.6+
- 网络连接（访问 FOFA 搜索引擎）
- MySQL 数据库（API 版本）

### 8.2 配置要求

- FOFA API 密钥
- 系统管理员权限（用于设置系统代理）

## 9. 未来规划

### 9.1 功能增强

- 支持更多代理协议
- 增加更多代理来源
- 优化代理验证算法
- 增强地区筛选功能

### 9.2 性能优化

- 提高代理验证速度
- 优化数据存储结构
- 减少资源占用

### 9.3 用户体验

- 改进 GUI 界面
- 增加数据可视化
- 提供更多自定义选项

## 10. 总结

Yccol 代理池系统是一个功能完善、架构清晰的代理 IP 管理工具，通过模块化设计和多种使用方式，满足了不同用户的需求。系统利用 FOFA 搜索引擎作为数据来源，结合多线程验证和智能管理，提供了高效可靠的代理 IP 服务。